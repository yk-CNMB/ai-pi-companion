<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Pico Debug</title>
    <!-- 核心库 -->
    <script src="/static/js/live2dcubismcore.min.js"></script>
    <script src="/static/js/pixi.min.js"></script>
    <script src="/static/js/pixi-live2d-display.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background-color: #333; font-family: sans-serif; }
        /* 调试信息显示区 */
        #debug-info {
            position: fixed; top: 0; left: 0; color: lime; background: rgba(0,0,0,0.7);
            padding: 10px; z-index: 9999; pointer-events: none; font-size: 14px; max-width: 100%;
        }
        #live2d-canvas { position: fixed; width: 100%; height: 100%; z-index: 1; }
        /* 暂时隐藏聊天界面，专注于调试模型 */
        #main-app-placeholder {
            position: relative; z-index: 2; height: 100vh; display: flex;
            align-items: center; justify-content: center; color: white;
            font-size: 24px; text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
    </style>
</head>
<body>
    <div id="debug-info">调试日志启动...</div>
    <canvas id="live2d-canvas"></canvas>
    
    <!-- 一个简单的占位符，代替复杂的聊天界面 -->
    <div id="main-app-placeholder">
        如果看到 Shizuku，说明成功了！
    </div>

    <script>
        const debug = document.getElementById('debug-info');
        function log(msg) {
            debug.innerHTML += '<br>' + msg;
            console.log(msg);
        }

        async function init() {
            log("1. 开始初始化 PixiJS...");
            try {
                const app = new PIXI.Application({
                    view: document.getElementById('live2d-canvas'),
                    autoStart: true,
                    resizeTo: window,
                    backgroundColor: 0x333333 // 给画布一个灰色背景
                });
                log("2. PixiJS 初始化成功");

                log("3. 开始加载模型文件...");
                // 强制指定模型路径
                const modelPath = '/static/live2d/shizuku/shizuku.model.json';
                log("-> 目标路径: " + modelPath);

                const model = await PIXI.live2d.Live2DModel.from(modelPath);
                log("4. 模型文件加载成功！");

                log("5. 正在添加到舞台...");
                app.stage.addChild(model);

                // 调整位置
                const scale = Math.min(window.innerWidth / model.width, window.innerHeight / model.height) * 0.8;
                model.scale.set(scale);
                model.x = (window.innerWidth - model.width * scale) / 2;
                model.y = (window.innerHeight - model.height * scale) / 2;
                
                log("6. ✅ 成功！你应该能看到她了！");

                // 尝试让她动一下
                model.internalModel.motionManager.startRandomMotion('idle');

            } catch (e) {
                log("❌ 失败: " + e.message);
                log("Possible causes: 文件 404 不存在，或者 JSON 格式错了");
                console.error(e);
            }
        }

        // 确保库已加载
        if (typeof PIXI === 'undefined') {
            log("❌ 严重错误: PixiJS 库未加载！请检查 static/js/");
        } else {
            init();
        }
    </script>
</body>
</html>

